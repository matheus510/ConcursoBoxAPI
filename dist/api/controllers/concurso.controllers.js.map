{"version":3,"sources":["../../../src/api/controllers/concurso.controllers.js"],"names":["create","findAllFinished","findAll","findOne","update","remove","req","res","body","status","send","message","concursoObj","Concurso","nome","realizadores","patrocinadores","dataInicio","dataTermino","participantes","terminado","save","then","data","catch","err","find","resObj","map","id","concurso","_id","length","findById","params","concursoId","kind","findByIdAndUpdate","new","findByIdAndRemove","name"],"mappings":"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","file":"concurso.controllers.js","sourcesContent":["import Concurso from '../../db/models/concurso.model'\n\nexport function create(req, res) {\n\t// Validate request\n\tif (!req.body) {\n\t\treturn res.status(400).send({\n\t\t\tmessage: \"Concurso nÃ£o pode ser vazio\"\n\t\t});\n\t}\n\t// Criar concurso\n\tconst concursoObj = new Concurso({\n\t\tnome: req.body.nome,\n\t\trealizadores: req.body.realizadores,\n\t\tpatrocinadores: req.body.patrocinadores,\n\t\tdataInicio: req.body.dataInicio,\n\t\tdataTermino: req.body.dataTermino,\n\t\tparticipantes: req.body.participantes,\n\t\tterminado: req.body.terminado ? req.body.terminado : false\n\t});\n\t// Salvar concurso\n\tconcursoObj.save()\n\t\t.then(data => {\n\t\t\tres.send(data);\n\t\t}).catch(err => {\n\t\t\tres.status(500).send({\n\t\t\t\tmessage: err.message || \"Erro ao criar o concurso.\"\n\t\t\t});\n\t\t});\n}\n\nexport function findAllFinished(req, res) {\n\t// Salvar concurso\n\tConcurso.find({ \"terminado\": true })\n\t\t.then(data => {\n\t\t\tconst resObj = data.map(concurso => {\n\t\t\t\treturn {\n\t\t\t\t\tid: concurso._id,\n\t\t\t\t\tnome: concurso.nome,\n\t\t\t\t\tdataInicio: concurso.dataInicio,\n\t\t\t\t\tdataTermino: concurso.dataTermino,\n\t\t\t\t\tparticipantes: concurso.participantes.length,\n\t\t\t\t\tterminado: concurso.terminado ? concurso.terminado : false\n\t\t\t\t}\n\t\t\t})\n\t\t\tres.send(resObj)\n\t\t}).catch(err => {\n\t\t\tres.status(500).send({\n\t\t\t\tmessage: err.message || \"Erro ao criar o concurso.\"\n\t\t\t})\n\t\t})\n}\n\nexport function findAll(req, res) {\n\t// Salvar concurso\n\tConcurso.find({ \"terminado\": false })\n\t\t.then(data => {\n\t\t\tconst resObj = data.map(concurso => {\n\t\t\t\treturn {\n\t\t\t\t\tid: concurso._id,\n\t\t\t\t\tnome: concurso.nome,\n\t\t\t\t\tdataInicio: concurso.dataInicio,\n\t\t\t\t\tdataTermino: concurso.dataTermino,\n\t\t\t\t\tparticipantes: concurso.participantes.length\n\t\t\t\t}\n\t\t\t})\n\t\t\tres.send(resObj)\n\t\t}).catch(err => {\n\t\t\tres.status(500).send({\n\t\t\t\tmessage: err.message || \"Erro ao criar o concurso.\"\n\t\t\t})\n\t\t})\n}\n\nexport function findOne(req, res) {\n\tConcurso.findById(req.params.concursoId)\n    .then(concurso => {\n        if(!concurso) {\n            return res.status(404).send({\n                message: \"concurso not found with id \" + req.params.concursoId\n            });            \n        }\n        res.send(concurso);\n    }).catch(err => {\n        if(err.kind === 'ObjectId') {\n            return res.status(404).send({\n                message: \"concurso not found with id \" + req.params.concursoId\n            });                \n        }\n        return res.status(500).send({\n            message: \"Error retrieving concurso with id \" + req.params.concursoId\n        });\n    });\n}\n\nexport function update(req, res) {\n\tConcurso.findByIdAndUpdate(req.params.concursoId, req.body, {new: true})\n\t.then(concurso => {\n\t\t\tif(!concurso) {\n\t\t\t\t\treturn res.status(404).send({\n\t\t\t\t\t\t\tmessage: \"concurso not found with id \" + req.params.concursoId\n\t\t\t\t\t});\n\t\t\t}\n\t\t\tres.send(concurso);\n\t}).catch(err => {\n\t\t\tif(err.kind === 'ObjectId') {\n\t\t\t\t\treturn res.status(404).send({\n\t\t\t\t\t\t\tmessage: \"concurso not found with id \" + req.params.concursoId\n\t\t\t\t\t});                \n\t\t\t}\n\t\t\treturn res.status(500).send({\n\t\t\t\t\tmessage: \"Error updating concurso with id \" + req.params.concursoId\n\t\t\t});\n\t});\n}\n\nexport function remove (req, res) {\n\tConcurso.findByIdAndRemove(req.params.concursoId)\n    .then(concurso => {\n        if(!concurso) {\n            return res.status(404).send({\n                message: \"concurso not found with id \" + req.params.concursoId\n            });\n        }\n        res.send({message: \"concurso deleted successfully!\"});\n    }).catch(err => {\n        if(err.kind === 'ObjectId' || err.name === 'NotFound') {\n            return res.status(404).send({\n                message: \"concurso not found with id \" + req.params.concursoId\n            });                \n        }\n        return res.status(500).send({\n            message: \"Could not delete concurso with id \" + req.params.concursoId\n        });\n    });\n}\n"]}